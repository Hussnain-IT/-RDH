<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Filtered Properties</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    {% load static %}
    <link rel="stylesheet" href="{% static 'sty4.css' %}">
</head>
<body>
<div class="main-cantainer-pro-UI">
    <h2 class="property-main-heading">Filtered Properties
        <a href="{% url 'add_property' %}" class="btn btn-success align-center" style="margin: 15px; box-sizing: border-box;">Add Property</a>
    </h2>
    <div class="search-filter-container" style="margin: 30px 0;">
        <form id="property-search-form" class="d-flex flex-wrap align-items-end" style="gap: 10px;" method="get" action="{% url 'property_search' %}">
            <input type="number" name="min_price" class="form-control" placeholder="Min Price" style="max-width: 140px;" value="{{ request.GET.min_price }}">
            <input type="number" name="max_price" class="form-control" placeholder="Max Price" style="max-width: 140px;" value="{{ request.GET.max_price }}">
            <select name="property_type" class="form-select" style="max-width: 160px;">
                <option value="" {% if not request.GET.property_type %}selected{% endif %}>Any Type</option>
                <option value="5_MARLA" {% if request.GET.property_type == '5_MARLA' %}selected{% endif %}>5 Marla</option>
                <option value="7_MARLA" {% if request.GET.property_type == '7_MARLA' %}selected{% endif %}>7 Marla</option>
                <option value="10_MARLA" {% if request.GET.property_type == '10_MARLA' %}selected{% endif %}>10 Marla</option>
                <option value="1_KANAL" {% if request.GET.property_type == '1_KANAL' %}selected{% endif %}>1 Kanal</option>
            </select>
            <button type="submit" class="btn btn-success" style="padding: 8px 24px; font-weight: 600;">Search</button>
        </form>
    </div>
    <div class="property-Section" id="property-list">
        {% if properties %}
            {% for property in properties %}
            <div class="box box-{{ forloop.counter }}">
                <div class="box-cont">
                    <h2>{{ property.get_property_type_display }}</h2>
                    {% if property.image %}
                    <div class="box-img" style="background-image: url('{{ property.image.url }}');"></div>
                    {% else %}
                    <div class="box-img" style="background-color: #eee;"></div>
                    {% endif %}
                    <p><strong>Price:</strong> {{ property.price|floatformat:0 }} PKR</p>
                    <p><strong>Location:</strong> {{ property.location }}</p>
                    <p><a href="{% url 'property_detail' property.id %}" style="text-decoration: none;">See more...</a></p>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="alert alert-warning">No properties found matching your criteria.</div>
        {% endif %}
    </div>
</div>
<footer>
    <a href="{% url 'home' %}" class="btn btn-success align-center" id="back-btn"><i class="fa-solid fa-left-long"></i> Back </a>
</footer>
<script src="{% static 'ProUI.js' %}"></script>
</body>
</html>
